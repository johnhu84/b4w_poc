if(b4w.module_check("example2_main"))throw"Failed to register module: example2_main";
b4w.register("example2_main",function(z,b){function A(a,e){if(e){var f=q.get_std_assets_path()+"tutorials/making_a_game_p4/game_example.json";B.load(f,C)}else console.log("b4w init failure")}function C(){h=x.get_first_character();g=x.get_object_by_dupli_name("character","character_rig");var u=a.create_custom_sensor(0),e=a.create_custom_sensor(0),f=a.create_custom_sensor(0),c=a.create_custom_sensor(0),b=a.create_custom_sensor(0);y()&&(E(u,f,e,c,b),document.getElementById("control_jump").style.visibility=
"visible");F(f,c);G(u,e);H(b);u=x.get_active_camera();I.append_semi_soft_cam(u,h,J,.2)}function F(b,e){function f(a,f,b){if(1==b)switch(f){case "FORWARD":var c=1;d.apply(g,"character_run_B4W_BAKED");break;case "BACKWARD":c=-1,d.apply(g,"character_run_B4W_BAKED")}else c=0,d.apply(g,"character_idle_01_B4W_BAKED");k.set_character_move_dir(a,c,0);d.play(g);d.set_behavior(g,d.AB_CYCLIC)}var c=a.create_keyboard_sensor(a.KEY_W),D=a.create_keyboard_sensor(a.KEY_S),L=a.create_keyboard_sensor(a.KEY_UP),n=a.create_keyboard_sensor(a.KEY_DOWN),
c=[c,L,b,D,n,e];a.create_sensor_manifold(h,"FORWARD",a.CT_TRIGGER,c,function(a){return a[0]||a[1]||a[2]},f);a.create_sensor_manifold(h,"BACKWARD",a.CT_TRIGGER,c,function(a){return a[3]||a[4]||a[5]},f);d.apply(g,"character_idle_01_B4W_BAKED");d.play(g);d.set_behavior(g,d.AB_CYCLIC)}function G(b,e){function f(b,f,c){var e=a.get_sensor_value(b,"LEFT",6);if(1==c)switch(f){case "LEFT":k.character_rotation_inc(b,1.5*e,0);break;case "RIGHT":k.character_rotation_inc(b,1.5*-e,0)}}var c=a.create_keyboard_sensor(a.KEY_A),
d=a.create_keyboard_sensor(a.KEY_D),g=a.create_keyboard_sensor(a.KEY_LEFT),n=a.create_keyboard_sensor(a.KEY_RIGHT),K=a.create_elapsed_sensor(),c=[c,g,e,d,n,b,K];a.create_sensor_manifold(h,"LEFT",a.CT_CONTINUOUS,c,function(a){return a[0]||a[1]||a[2]},f);a.create_sensor_manifold(h,"RIGHT",a.CT_CONTINUOUS,c,function(a){return a[3]||a[4]||a[5]},f)}function H(b){var e=a.create_keyboard_sensor(a.KEY_SPACE);a.create_sensor_manifold(h,"JUMP",a.CT_SHOT,[e,b],function(a){return a[0]||a[1]},function(a){k.character_jump(a)})}
function E(b,e,f,c,d){function g(r){r.preventDefault();r=r.changedTouches;for(var w=0;w<r.length;w++)r[w].identifier==h?(a.set_custom_sensor(e,0),a.set_custom_sensor(c,0),a.set_custom_sensor(f,0),a.set_custom_sensor(b,0),p.style.visibility="hidden",t.style.visibility="hidden",h=null):r[w].identifier==k&&(a.set_custom_sensor(d,0),k=null)}var n=new Float32Array(2),h,k,p=document.getElementById("control_tap"),t=document.getElementById("control_circle"),v=p.clientWidth/2,q=t.clientWidth/2;document.getElementById("canvas3d").addEventListener("touchstart",
function(a){a.preventDefault();var b=window.innerWidth;a=a.changedTouches;for(var c=0;c<a.length;c++){var f=a[c],e=f.clientX,d=f.clientY;if(e>b/2)break;n[0]=e;n[1]=d;h=f.identifier;p.style.visibility="visible";p.style.left=e-v+"px";p.style.top=d-v+"px";t.style.visibility="visible";t.style.left=e-q+"px";t.style.top=d-q+"px"}},!1);document.getElementById("control_jump").addEventListener("touchstart",function(b){b.preventDefault();b=b.changedTouches;for(var c=0;c<b.length;c++){var e=b[c];a.set_custom_sensor(d,
1);k=e.identifier}},!1);document.getElementById("canvas3d").addEventListener("touchmove",function(d){d.preventDefault();a.set_custom_sensor(e,0);a.set_custom_sensor(c,0);a.set_custom_sensor(f,0);a.set_custom_sensor(b,0);var g=window.innerWidth;d=d.changedTouches;for(var h=0;h<d.length;h++){var l=d[h],m=l.clientX,l=l.clientY;if(m>g/2)break;p.style.left=m-v+"px";p.style.top=l-v+"px";var m=m-n[0],l=l-n[1],k=Math.sqrt(m*m+l*l);if(16>k)break;m/=k;l=-l/k;m>Math.cos(3*Math.PI/8)?a.set_custom_sensor(b,1):
m<-Math.cos(3*Math.PI/8)&&a.set_custom_sensor(f,1);l>Math.sin(Math.PI/8)?a.set_custom_sensor(e,1):l<-Math.sin(Math.PI/8)&&a.set_custom_sensor(c,1)}},!1);document.getElementById("canvas3d").addEventListener("touchend",g,!1);document.getElementById("controls").addEventListener("touchend",g,!1)}function y(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||
navigator.userAgent.match(/Windows Phone/i)?!0:!1}var d=b("animation"),M=b("app"),q=b("config");b("main");var B=b("data");b("container");var a=b("controls"),k=b("physics"),I=b("constraints");b("input");var x=b("scenes");b("transform");b("print");var h=null,g=null,J=new Float32Array([0,4,1.5]);z.init=function(){var a=y()?q.P_LOW:q.P_HIGH;M.init({canvas_container_id:"canvas3d",callback:A,physics_enabled:!0,quality:a,show_fps:!0,autoresize:!0,alpha:!1})}});b4w.require("example2_main").init();
