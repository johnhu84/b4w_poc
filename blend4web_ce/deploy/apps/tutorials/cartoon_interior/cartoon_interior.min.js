b4w.register("cartoon_interior",function(N,e){function O(a,c){c?(C.create_preloader(),a.addEventListener("mousedown",D),a.addEventListener("touchstart",D),a.addEventListener("mouseup",E),a.addEventListener("touchend",E),a.addEventListener("mousemove",F),a.addEventListener("touchmove",F),window.onresize=y.resize_to_container,y.resize_to_container(),l.load(n+"environment.json",P,Q)):console.log("b4w init failure")}function Q(a){C.update_preloader(a)}function P(){r.enable_camera_controls(!1,!1,!1,y.get_canvas());
R();var a=k.get_object_by_name("spawner");g.get_translation(a,z)}function R(){document.getElementById("controls-container").style.display="block";S();document.getElementById("load-1").addEventListener("click",function(){l.load(n+"bed.json",t,null,null,!0)});document.getElementById("load-2").addEventListener("click",function(){l.load(n+"chair.json",t,null,null,!0)});document.getElementById("load-3").addEventListener("click",function(){l.load(n+"commode_and_pot.json",t,null,null,!0)});document.getElementById("load-4").addEventListener("click",
function(){l.load(n+"fan.json",t,null,null,!0)});document.getElementById("load-5").addEventListener("click",function(){l.load(n+"table.json",t,null,null,!0)});document.getElementById("delete").addEventListener("click",function(){if(f){var a=k.get_object_data_id(f);l.unload(a);f=null}});document.getElementById("rot-ccw").addEventListener("click",function(){f&&G(f,H)});document.getElementById("rot-cw").addEventListener("click",function(){f&&G(f,-H)})}function S(){for(var a=["delete","rot-ccw","rot-cw"],
c=0;c<a.length;c++){var b=a[c];document.getElementById(b).addEventListener("mousedown",function(a){a.target.parentNode.classList.add("active")});document.getElementById(b).addEventListener("mouseup",function(a){a.target.parentNode.classList.remove("active")});document.getElementById(b).addEventListener("touchstart",function(a){a.target.parentNode.classList.add("active")});document.getElementById(b).addEventListener("touchend",function(a){a.target.parentNode.classList.remove("active")})}}function t(a){a=
k.get_all_objects("ALL",a);for(var c=0;c<a.length;c++){var b=a[c];if(I.has_physics(b)){I.enable_simulation(b);var d=p.create_collision_sensor(b,"FURNITURE"),e=p.create_selection_sensor(b,!0);b==f&&p.set_custom_sensor(e,1);p.create_sensor_manifold(b,"COLLISION",p.CT_CONTINUOUS,[d,e],T,U);(d=h.get_parent(b))&&h.is_armature(d)?g.set_translation_v(d,z):g.set_translation_v(b,z)}h.is_mesh(b)&&k.show_object(b)}}function T(a){return a[1]}function U(a,c,b){1==b&&(p.get_sensor_value(a,c,0)?k.set_outline_color(V):
k.set_outline_color(W))}function G(a,c){var b=h.get_parent(a);if(b&&h.is_armature(b)){var d=g.get_rotation(b,J);K.rotateZ(d,c,d);g.set_rotation_v(b,d)}else d=g.get_rotation(a,J),K.rotateZ(d,c,d),g.set_rotation_v(a,d);L(a)}function D(a){A=!0;a.preventDefault&&a.preventDefault();var c=v.get_coords_x(a);a=v.get_coords_y(a);var b=k.pick_object(c,a);f!=b&&(f&&k.clear_outline_anim(f),b&&k.apply_outline_anim(b,1,1,0),f=b);if(f){var b=k.get_active_camera(),d=h.get_parent(f);d&&h.is_armature(d)?g.get_translation(d,
q):g.get_translation(f,q);M.project_point(b,q,m);m[0]=c-m[0];m[1]=a-m[1]}}function E(){A=!1;w||(r.enable_camera_controls(),w=!0)}function F(a){if(A&&f){w&&(r.disable_camera_controls(),w=!1);var c=k.get_active_camera(),b=v.get_coords_x(a);a=v.get_coords_y(a);0<=b&&0<=a&&(b-=m[0],a-=m[1],b=M.calc_ray(c,b,a,x),b=u.get_pline_directional_vec(b,q),c=g.get_translation(c,X),u.set_pline_initial_point(x,c),u.set_pline_directional_vec(x,b),(c=u.line_plane_intersect(Y,0,x,Z))&&0>b[2]&&((b=h.get_parent(f))&&h.is_armature(b)?
g.set_translation_v(b,c):g.set_translation_v(f,c),L(f)))}}function L(a){var c=g.get_object_bounding_box(a),b=h.get_parent(a),d=b&&h.is_armature(b)?g.get_translation(b,q):g.get_translation(a,q);4<c.max_x?d[0]-=c.max_x-4:-3.8>c.min_x&&(d[0]+=-3.8-c.min_x);3.5<c.max_y?d[1]-=c.max_y-3.5:-4.2>c.min_y&&(d[1]+=-4.2-c.min_y);b&&h.is_armature(b)?g.set_translation_v(b,d):g.set_translation_v(a,d)}var r=e("app"),M=e("camera"),aa=e("config"),y=e("container"),p=e("controls"),l=e("data"),v=e("mouse"),u=e("math"),
h=e("objects"),I=e("physics"),C=e("preloader"),k=e("scenes"),g=e("transform");e("util");var ba=e("version"),K=e("quat"),B="DEBUG"===ba.type(),W=[0,1,0],V=[1,0,0],Y=[0,0,1],H=Math.PI/4,n=aa.get_std_assets_path()+"tutorials/cartoon_interior/",m=new Float32Array(2),z=new Float32Array(3),q=new Float32Array(3),X=new Float32Array(3),Z=new Float32Array(3),J=new Float32Array(4),x=u.create_pline(),A=!1,w=!0,f=null;N.init=function(){var a=B,c=r.get_url_params();c&&"show_fps"in c&&(a=!0);r.init({canvas_container_id:"main_canvas_container",
callback:O,physics_enabled:!0,show_fps:a,alpha:!1,assets_dds_available:!B,assets_min50_available:!B,background_color:[1,1,1,0]})}});b4w.require("cartoon_interior").init();
